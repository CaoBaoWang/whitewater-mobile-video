{"version":3,"sources":["whitewater.js"],"names":["Whitewater","canvas","inputPath","options","addCanvasMethods","this","play","pause","playpause","stop","checkImagesLoaded","imagesLoaded","settings","imagesRequired","setAttribute","state","loadEvent","CustomEvent","getEventOptions","call","dispatchEvent","autoplay","drawFrame","frameToDraw","currentFrame","firstImage","getPrecompositedFrame","frames","context","drawImage","setProgress","detail","video","progress","timestamp","maxTime","secondsElapsed","bubbles","cancelable","frameToRender","buffer","document","createElement","width","videoWidth","height","videoHeight","j","length","position","consecutive","positionArray","getCoordinatesFromPosition","chunkWidth","blockSize","getContext","diffImages","imageIndex","coordinates","x","y","sourceGrid","loadRequiredImages","Video","addEventListener","setPosterImage","src","path","format","i","image","Image","bind","push","parseManifestFile","callbacks","onManifestLoad","manifest","JSON","parse","request","responseText","error","constructor","_throwError","setVideoOptions","setSize","myWorker","webWorker","toBase10","val","r","order","num","indexOf","charAt","substr","workerIsIncluded","onmessage","e","data","videoData","frame","frameData","map","match","mapLength","postMessage","URL","window","webkitURL","workerBlob","Blob","toString","type","Worker","createObjectURL","event","terminate","controls","setPlayPauseControls","onManifestError","errors","MANIFEST","XMLHttpRequest","open","send","resetVideo","clearRect","setCanvasElement","HTMLCanvasElement","CANVAS","setFilePath","PATH","setOptions","speed","loop","element","clickEvent","getClickEvent","top","style","paddingTop","background","backgroundSize","getNumberWithDecimals","frameCount","currentTime","framesPerSecond","getFormattedTime","playingEvent","Math","round","lengthInSeconds","init","callAfterManifest","isTouchDevice","documentElement","endEvent","columns","ceil","floor","time","minutes","seconds","milliseconds","number","digits","multiplier","pow","animationFrame","supported","pauseEvent","cancelAnimationFrame","animate","currentTimeStamp","previousTimestamp","requestAnimationFrame","interval","loopEvent","lag","playEvent","performance","now","stopEvent","pre","MISC","WEBWORKERS","BLOBCONSTRUCTOR","_checkSupport","console","warn"],"mappings":"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","file":"whitewater.min.js"}