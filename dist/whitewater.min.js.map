{"version":3,"sources":["whitewater.js"],"names":["Whitewater","canvas","inputPath","options","addCanvasMethods","this","play","pause","playpause","stop","addVisibilityListener","document","hiddenProperty","addEventListener","softPause","bind","window","checkImagesLoaded","imagesLoaded","settings","imagesRequired","setAttribute","state","loadEvent","CustomEvent","getEventOptions","call","dispatchEvent","autoplay","drawFrame","frameToDraw","currentFrame","firstImage","getPrecompositedFrame","frames","context","drawImage","setProgress","detail","video","progress","timestamp","maxTime","secondsElapsed","bubbles","cancelable","frameToRender","buffer","createElement","width","videoWidth","height","videoHeight","j","length","position","consecutive","positionArray","getCoordinatesFromPosition","chunkWidth","blockSize","getContext","diffImages","imageIndex","coordinates","x","y","sourceGrid","loadRequiredImages","Video","setPosterImage","src","path","format","i","image","Image","push","parseManifestFile","callbacks","onManifestLoad","manifest","JSON","parse","request","responseText","error","constructor","_throwError","setVideoOptions","setSize","myWorker","webWorker","toBase10","val","r","order","num","indexOf","charAt","substr","workerIsIncluded","onmessage","e","data","videoData","frame","frameData","map","match","mapLength","postMessage","URL","webkitURL","workerBlob","Blob","toString","type","Worker","createObjectURL","event","terminate","controls","setPlayPauseControls","onManifestError","errors","MANIFEST","XMLHttpRequest","open","send","resetVideo","clearRect","setCanvasElement","HTMLCanvasElement","CANVAS","setFilePath","PATH","setOptions","speed","loop","element","clickEvent","getClickEvent","top","style","paddingTop","background","backgroundSize","getNumberWithDecimals","frameCount","currentTime","framesPerSecond","getFormattedTime","playingEvent","Math","round","lengthInSeconds","hidden","undefined","documentHidden","init","callAfterManifest","isTouchDevice","documentElement","endEvent","columns","ceil","floor","time","minutes","seconds","milliseconds","number","digits","multiplier","pow","animationFrame","supported","pauseEvent","cancelAnimationFrame","animate","timeSinceLastDraw","previousTime","interval","loopEvent","lag","requestAnimationFrame","resume","playEvent","performance","now","stopEvent","pre","MISC","WEBWORKERS","BLOBCONSTRUCTOR","VISIBILITYAPI","_checkSupport","console","warn"],"mappings":"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","file":"whitewater.min.js"}